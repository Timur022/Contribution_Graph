<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contribution Graph</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/script.js"></script>
</head>
<body>
    <div class="main">
        <table id="contr">
            <tr id="head"></tr>
        </table>
    </div>
    <div>
        
    </div>
    <script type='text/javascript'>
        function httpGet(theUrl)
        {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", theUrl, false );
            xmlHttp.send( null );
            return xmlHttp.responseText;
        }
        var myArr = JSON.parse(httpGet("https://dpg.gg/test/calendar.json"));
        console.log(myArr["2022-10-26"]);
        var now = new Date();
        var days = [];
        var d = 0
        for (let j = 0; j < 7; j++) {
            for (let i = 356; i >= 0; i--) {
                var date = new Date(parseInt(+now)-(86400000*i));
                if (wd[j]==date.getDay()) {
                    var dict = {};
                    var month = (date.getMonth()+1);
                    if (parseInt(month) < 10){
                        month = "0"+month;
                    }
                    dict['Date'] = date.getFullYear()+"-"+month+"-"+date.getDate();
                    dict['Contributions'] = myArr[date.getFullYear()+"-"+month+"-"+date.getDate()];
                    days[d] = dict;
                    d++;
                }
            }
        }
        console.log(days);
        // parseInt(+date/1000)
        let head = document.getElementById("head");
        var colspannn = 0
        for (var i = 12; i > 0; i--) {
            let th = document.createElement('th');
            date = new Date(parseInt(+now)-(2592000000*(i-1)))
            th.innerHTML = month_all[date.getMonth()];
            if (colspannn == 1) {
                th.setAttribute('colspan', "5");
                colspannn = 0
            }
            else {
                th.setAttribute('colspan', "4");
                colspannn = colspannn + 0.25
            }
            head.appendChild(th);
        }
        let table = document.querySelector('#contr');
        for (let j = 0; j < 7; j++) {
            let tr = document.createElement('tr');
            for (let i = 0; i < 50; i++) {
                // const att = document.createAttribute("name");
                // att.value = "-"++"-";
                let td = document.createElement('td');
                td.setAttribute('name', days[(i+1)*(j+1)].Date);
                td.setAttribute('class', "td");
                var color = "#DEDEDE"
                if (days[(i+1)*(j+1)].Contributions >= 1 && days[(i+1)*(j+1)].Contributions <= 9){
                    color = "#C5E3E6"
                }
                else if (days[(i+1)*(j+1)].Contributions >= 10 && days[(i+1)*(j+1)].Contributions <= 19){
                    color = "#87B4EC"
                }
                else if (days[(i+1)*(j+1)].Contributions >= 20 && days[(i+1)*(j+1)].Contributions <= 29){
                    color = "#536CBE"
                }
                else if (days[(i+1)*(j+1)].Contributions >= 30){
                    color = "#344DA9"
                }
                td.style.backgroundColor = color;
                tr.appendChild(td);
                // d--;
            }
            table.appendChild(tr);
        }
    </script>
</body>
</html>